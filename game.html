<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Party Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Courier New', monospace;
            background-color: #f5f5f5;
            color: #000000;
            min-height: 100vh;
            padding: 20px;
        }
        .home-link {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 24px;
            height: 24px;
            text-decoration: none;
            cursor: pointer;
        }
        .home-link:hover {
            opacity: 0.7;
        }
        .home-icon {
            width: 24px;
            height: 24px;
            fill: #000;
        }
        .container {
            max-width: 500px;
            margin: 80px auto 0;
            text-align: center;
        }
        .message {
            font-size: 16px;
            text-align: left;
            line-height: 1.6;
            margin-bottom: 40px;
        }
        .nav-button {
            display: inline-block;
            padding: 16px 48px;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            background-color: #000000;
            color: #ffffff;
            border: none;
            border-radius: 0;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-decoration: none;
            transition: background-color 0.2s;
        }
        .nav-button:hover {
            background-color: #333333;
        }
        .nav-button.disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            pointer-events: none;
        }
        .button-note {
            font-size: 13px;
            color: #666;
            margin-top: 12px;
            font-style: italic;
        }
        .loading {
            text-align: center;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <a href="home.html" class="home-link">
        <svg class="home-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg>
    </a>
    <div class="container">
        <div class="message" id="gameMessage">
            <span class="loading">Loading...</span>
        </div>
        
        <a href="game2.html" class="nav-button" id="nextBtn">Next</a>
        <p class="button-note">(This link opens at 10pm)</p>
    </div>
    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwlKG2IPyyUa777K4gfiofiUpAGMofW1dKCY0pHSz0VuULgEwU8kZFxyCcLF0JdkVS20A/exec';
        
        // Greeting dictionary
        const greetingByLanguage = {
            "Finnish": "Moi, mitä kuuluu? (moy, mee-tah KOO-loo)",
            "Arabic": "أهلًا، إزيّك؟ (ahlan, izzayyak?)",
            "Russian": "Привет, как дела? (pree-VYET, kak dye-LAH)",
            "Hindi": "नमस्ते, कैसे हो? (nuh-MUH-stay, KAY-say hoh?)",
            "Mandarin Chinese": "你好，你怎么样？ (nee-HOW, nee zen-muh YANG?)",
            "Japanese": "やあ、元気？ (yah, GEN-kee?)",
            "Korean": "안녕, 잘 지내? (ahn-NYUNG, jal ji-NAY?)",
            "Thai": "หวัดดี, สบายดีไหม? (wat-DEE, sa-BYE dee mai?)",
            "Amharic": "ሰላም፣ እንዴት ነህ? (seh-LAHM, in-DAYT neh?)",
            "Swahili": "Habari, ukoje? (hah-BAH-ree, oo-KOH-jeh)",
            "French": "Salut, ça va ? (sah-LOO, sah vah)",
            "Quechua": "Allillanchu, imaynallan kashanki? (ah-yee-YAHN-choo, ee-mine-AH-yan kah-SHAHN-kee)",
            "Greek": "Γεια, τι κάνεις; (yah, tee KAH-nees)"
        };
        
        // Redirect if not logged in
        const userName = localStorage.getItem('partyName');
        const userAlias = localStorage.getItem('partyAlias');
        
        if (!userName) {
            window.location.href = 'index.html';
        }
        
        // Load participant data to get country and language
        async function loadParticipantData() {
            try {
                const url = `${SCRIPT_URL}?action=getParticipants`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.participants) {
                    // Find current user's data
                    const participant = data.participants.find(p => p.name === userName || p.alias === userAlias);
                    
                    if (participant) {
                        const alias = participant.alias || userAlias || 'Traveler';
                        const country = participant.country || 'a far away land';
                        const language = participant.language || 'Finnish';
                        const greeting = greetingByLanguage[language] || greetingByLanguage['Finnish'];
                        
                        document.getElementById('gameMessage').innerHTML = `
                            Hi, ${alias}, welcome to the International Embassy! You must've travelled a long way from ${country}. Today, your goal is simple: Get approved for travel to the country of your choice!
                            <br><br>
                            As you mingle, you may run into a few of your fellow countrymen. Make sure to greet them with a "${greeting}". "Hi, how're you?" also works!
                            <br><a href="https://www.youtube.com/watch?v=WGqoaGgTFAQ" style="font-size: 5px; color: #666;">relevant-clip-but-not-an-endorsement</a>
                        `;
                    } else {
                        // Fallback if participant not found
                        showFallbackMessage();
                    }
                } else {
                    showFallbackMessage();
                }
            } catch (error) {
                console.error('Error loading participant data:', error);
                showFallbackMessage();
            }
        }
        
        function showFallbackMessage() {
            const alias = userAlias || 'Traveler';
            document.getElementById('gameMessage').innerHTML = `
                Hi, ${alias}, welcome to the International Embassy! You must've travelled a long way. Today, your goal is simple: Get approved for travel to the country of your choice!
                <br><br>
                As you mingle, you may run into a few of your fellow countrymen. Make sure to greet them warmly. "Hi, how're you?" works great!
            `;
        }
        
        // Load data on page load
        loadParticipantData();
    </script>
</body>
</html>
